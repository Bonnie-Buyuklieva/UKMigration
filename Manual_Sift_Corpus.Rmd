---
title: "Manual_Sift_Corpus"
author: "Boyana Buyuklieva"
date: "August 1, 2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(readxl)
library(stringr)
library(ggplot2)
```

```{r, cache=TRUE }
sifted <- read_excel("C:/Users/billi/Dropbox/_PhD/__PhD Book/Writing Drafts/_Februrary_Draft/Lit_Review - scholar/Final_Data/Excel/seedcorpus_sifted_cleaned.xlsx",
    na = "NA",
    col_types = c("numeric", "text", "text", 
        "text", "text", "text", 
        "text", "skip", "numeric", "numeric", 
        "numeric", "numeric", "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", "numeric"))

#do not add anything
sifted$horizontalDepth <- NULL
sifted$`Paper Reviewed`<- NULL



names(sifted)
#queries start from 6
```

#	Which queries lost most?
```{r}
#	Which queries lost most?
removed <- subset(sifted, grepl("N", sifted$`Pass 2`), drop = TRUE)

#replace rank with 1s
removed[,6:16] <- apply(removed[,6:16], 2, function(x) ifelse(!is.na(as.numeric(x)),1,0) )

droped <- data.frame(count = sort(colSums(removed[,6:16]), decreasing = T))
droped$query = rownames(droped )

droped
```

#	Which papers hit most queries?

```{r}
sifted_bool <- sifted
sifted_bool[,6:16] <- apply(sifted_bool[,6:16], 2, function(x) ifelse(!is.na(x),1,0) )

hits <- data.frame(count = sort(rowSums(sifted_bool[,6:16]), decreasing = T))
hits <- cbind (sifted_bool[,c('title')], hits)

print('Most papers hit only one query:')
summary(as.factor(hits$count))


print('The ones that covered most are:')
head(hits[,c('title','count')], 8)
```


#	How much to queries overlap?
```{r}

querySum <- as.data.frame(colnames(sifted_bool[,6:16]))
colnames(QuerySum) <- 'keywords'
querySum <- cbind(QuerySum, shortHand = seq(from = 1, to = lengths(q), by = 1))
#total num of papers = 760, 100 per query. But there are overlaps. 

qpairMatches <- data.frame()

for (start in 6:15){
  for (col in start:16){
    if(col<16){
      nextcol <- col+1
      tmp <- sifted_bool[,col]+ sifted_bool[,nextcol]
      print( paste(colnames(sifted_bool[,col]), '+', colnames(sifted_bool[, nextcol]) ))
      print(sum(tmp == 2))

      tmp <- cbind(colnames(sifted_bool[,col]), colnames(sifted_bool[, nextcol]), sum(tmp == 2))
      qpairMatches <- rbind(qpairMatches,tmp)
    }else{
      break
    }
  }
}









```

